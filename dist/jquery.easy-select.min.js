/*
 *  jQuery Easy Select - v1.0.0
 *  Easy Select is simply a drop down list integrated with an input field.
 *  http://www.webdeveasy.com/easy-select-plugin
 *
 *  Made by NaorYe
 */
!function(a,b){function c(b,c){this.element=a(b),this.settings=a.extend({},e,c),this._initialize()}var d="easySelect",e={items:[],idKey:"id",textKey:"text",onSelect:null};c.prototype={_initialize:function(){this._createDropDown(),this._openDropDown=a.proxy(this._openDropDown,this),this._triggerDropDownClose=a.proxy(this._triggerDropDownClose,this),this._matchQuery=a.proxy(this._matchQuery,this),this._disableDropDownClose=a.proxy(this._disableDropDownClose,this),this._selectDropDownItem=a.proxy(this._selectDropDownItem,this),this._closeDropDown=a.proxy(this._closeDropDown,this),this.element.on("focus",this._openDropDown).on("blur",this._triggerDropDownClose).on("keyup",this._matchQuery),this.dropDown.on("focus",this._disableDropDownClose).on("click",this._selectDropDownItem).on("blur",this._closeDropDown)},destroy:function(){this.element.off("focus",this._openDropDown).off("blur",this._triggerDropDownClose).off("keyup",this._matchQuery),this.dropDown.remove()},setItems:function(a){this.settings.items=a,this._listItems()},_triggerDropDownClose:function(){this._dropDownCloseTimeoutId=b.setTimeout(a.proxy(this._closeDropDown,this),200)},_disableDropDownClose:function(){b.clearTimeout(this._dropDownCloseTimeoutId)},_positionDropDown:function(){var b=this.element.offset(),c=a("body");this.dropDown.css({top:b.top+this.element.outerHeight(!1),left:b.left,width:this.element.outerWidth(!1),"margin-left":"-"+c.css("margin-left"),"margin-right":"-"+c.css("margin-right"),"margin-top":"-"+c.css("margin-top"),"margin-bottom":"-"+c.css("margin-bottom")})},_listItems:function(){var b=this.settings,c=this.dropDown.find(".items");c.find(".item").remove(),b.items&&b.items.length>0&&b.items.forEach(function(d){a('<li class="item" data-value="'+d[b.idKey]+'">'+d[b.textKey]+"</li>").appendTo(c)}),a('<li class="item unselectable empty">No results found</li>').appendTo(c)},_createDropDown:function(){this.dropDown=a('<div class="easy-select"><ul class="items"></ul></div>').appendTo("body"),this._listItems(),this._closeDropDown()},_matchQuery:function(){var b=this.element.val().toLowerCase(),c=0;this.dropDown.find(".item").each(function(d,e){e=a(e),0===e.text().toLowerCase().indexOf(b)?(e.show(),c++):e.hide()}),0===c?this.dropDown.find(".empty").show():this.dropDown.find(".empty").hide()},getValue:function(){var b,c,d=this.element.val(),e=null,f=this.dropDown.find(".item:contains("+d+")");for(b=0;b<f.length&&null===e;b++)c=a(f[b]).text(),c===d&&(e=a(f[b]).data("id"));return e},_openDropDown:function(){this._matchQuery(),this.element.addClass("open"),this._positionDropDown(),this.dropDown.show()},_closeDropDown:function(){var a=this.getValue(),b=this.settings.onSelect;null===a&&this.element.val("").data("selectedId",""),b&&"function"==typeof b&&b(a),this.element.removeClass("open"),this.dropDown.hide()},_selectDropDownItem:function(b){this._disableDropDownClose();var c,d,e=a(b.target);e.hasClass("unselectable")||(c=e.data("id"),d=e.text(),this.element.val(d).data("selectedId",c)),this._closeDropDown()}},a.fn[d]=function(b){return this.each(function(){if(!a.data(this,d)){var e=new c(this,b);a.data(this,d,{getValue:a.proxy(e.getValue,e),setItems:a.proxy(e.setItems,e),destroy:a.proxy(e.destroy,e)})}})}}(jQuery,window,document);